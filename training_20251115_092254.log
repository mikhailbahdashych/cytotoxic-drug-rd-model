[Device] Używam: cuda
[OK] SciPy dostępny
[Zapisano trajektorię] out/explicit_Nx96_Ny96_traj.csv
[Zapisano metadane] out/explicit_Nx96_Ny96_info.json
[Zapisano macierz] out/explicit_Nx96_Ny96_S_final.npy
[Zapisano macierz] out/explicit_Nx96_Ny96_R_final.npy
[Zapisano macierz] out/explicit_Nx96_Ny96_I_final.npy
[Zapisano macierz] out/explicit_Nx96_Ny96_C_final.npy
[Zapisano wykres] figs/explicit_S_final.png
[Zapisano wykres] figs/explicit_R_final.png
[Zapisano wykres] figs/explicit_I_final.png
[Zapisano wykres] figs/explicit_C_final.png
[Zapisano trajektorię] out/semi_implicit_Nx96_Ny96_traj.csv
[Zapisano metadane] out/semi_implicit_Nx96_Ny96_info.json
[Zapisano macierz] out/semi_implicit_Nx96_Ny96_S_final.npy
[Zapisano macierz] out/semi_implicit_Nx96_Ny96_R_final.npy
[Zapisano macierz] out/semi_implicit_Nx96_Ny96_I_final.npy
[Zapisano macierz] out/semi_implicit_Nx96_Ny96_C_final.npy
[Zapisano wykres] figs/semi_implicit_S_final.png
[Zapisano wykres] figs/semi_implicit_R_final.png
[Zapisano wykres] figs/semi_implicit_I_final.png
[Zapisano wykres] figs/semi_implicit_C_final.png
[Zapisano wykres] figs/compare_tb.png
[explicit] N=64  dt=9.070e-04  time=1.79s  TB=0.01344
[semi_implicit] N=64  dt=2.000e-02  time=2.66s  TB=0.01149
[explicit] N=96  dt=3.989e-04  time=6.10s  TB=0.01357
[semi_implicit] N=96  dt=2.000e-02  time=6.96s  TB=0.01149
[explicit] N=128  dt=2.232e-04  time=18.92s  TB=0.01358
[semi_implicit] N=128  dt=2.000e-02  time=14.41s  TB=0.01149
[Zapisano] out/benchmark_resolutions.csv
[Zapisano wykres] figs/benchmark_time_vs_N.png
[explicit] dt=1.008e-03 steps=4962 time=1.27s
[explicit] dt=6.719e-04 steps=7442 time=1.92s
[explicit] dt=5.039e-04 steps=9923 time=2.57s
[explicit] dt=3.359e-04 steps=14884 time=4.17s
[Zapisano wykres] figs/stability_vs_dt_explicit.png
D_C=0.005 -> TB_final=0.01149 (solver=semi_implicit, dt=2.000e-02)
D_C=0.01 -> TB_final=0.01149 (solver=semi_implicit, dt=2.000e-02)
D_C=0.02 -> TB_final=0.01149 (solver=semi_implicit, dt=2.000e-02)
D_C=0.03 -> TB_final=0.01149 (solver=semi_implicit, dt=2.000e-02)
alpha_S=0.4 -> TB_final=0.01855 (solver=semi_implicit, dt=2.000e-02)
alpha_S=0.8 -> TB_final=0.01149 (solver=semi_implicit, dt=2.000e-02)
alpha_S=1 -> TB_final=0.01027 (solver=semi_implicit, dt=2.000e-02)
alpha_S=1.2 -> TB_final=0.00962 (solver=semi_implicit, dt=2.000e-02)
mu_max=0 -> TB_final=0.01016 (solver=semi_implicit, dt=2.000e-02)
mu_max=0.02 -> TB_final=0.01071 (solver=semi_implicit, dt=2.000e-02)
mu_max=0.05 -> TB_final=0.01149 (solver=semi_implicit, dt=2.000e-02)
mu_max=0.1 -> TB_final=0.01268 (solver=semi_implicit, dt=2.000e-02)
[Zapisano] out/param_sweep_basic.csv
[Zapisano wykres] figs/param_Dc_tb.png
[Zapisano wykres] figs/param_alphaS_tb.png
[Zapisano wykres] figs/param_mu_tb.png
[Zapisano trajektorię] out/compare_explicit_N96_traj.csv
[Zapisano metadane] out/compare_explicit_N96_info.json
[Zapisano macierz] out/compare_explicit_N96_S_final.npy
[Zapisano macierz] out/compare_explicit_N96_R_final.npy
[Zapisano macierz] out/compare_explicit_N96_I_final.npy
[Zapisano macierz] out/compare_explicit_N96_C_final.npy
[Tworzenie GIF dla explicit...]
  Liczba klatek: 39, dt=0.000399, save_every=400
[Zapisano animację] figs/compare_explicit_animation.gif
[Zapisano wykres] figs/compare_explicit_all_fields_final.png
[Zapisano trajektorię] out/compare_semi_implicit_N96_traj.csv
[Zapisano metadane] out/compare_semi_implicit_N96_info.json
[Zapisano macierz] out/compare_semi_implicit_N96_S_final.npy
[Zapisano macierz] out/compare_semi_implicit_N96_R_final.npy
[Zapisano macierz] out/compare_semi_implicit_N96_I_final.npy
[Zapisano macierz] out/compare_semi_implicit_N96_C_final.npy
[Tworzenie GIF dla semi_implicit...]
  Liczba klatek: 16, dt=0.020000, save_every=20
[Zapisano animację] figs/compare_semi_implicit_animation.gif
[Zapisano wykres] figs/compare_semi_implicit_all_fields_final.png
[Zapisano wykres] figs/compare_solvers_tb.png
Relatywna różnica krzywych TB (norma 2): 1.220e-14
[Zapisano] out/compare_solvers_same_dt.csv
[Zapisano wykres] figs/compare_solvers_same_dt.png
[Zapisano wykres] figs/compare_solvers_same_dt_diff.png
D_C=0.005 -> TB_final=0.02611
D_C=0.01 -> TB_final=0.02625
D_C=0.02 -> TB_final=0.02656
D_C=0.03 -> TB_final=0.02680
D_C=0.05 -> TB_final=0.02711
[Zapisano] out/robin_beta_sweep_Dc.csv
[Zapisano wykres] figs/robin_beta_Dc_influence.png
alpha_S=0.4 [LO] -> TB_final=0.01401, time=2.64s
alpha_S=1.2 [HI] -> TB_final=0.00809, time=2.47s
mu_max=0.0 [LO] -> TB_final=0.00768, time=2.41s
mu_max=0.1 [HI] -> TB_final=0.01031, time=2.43s
lam=0.05 [LO] -> TB_final=0.00663, time=2.41s
lam=0.5 [HI] -> TB_final=0.01391, time=2.43s
sigma=0.0 [LO] -> TB_final=0.00910, time=3.03s
sigma=0.1 [HI] -> TB_final=0.00908, time=2.49s
[Zapisano] out/extremes_summary.csv
[Zapisano wykres] figs/extremes_tb_bar.png
[Zapisano wykres] figs/panel_maps_explicit.png
[Zapisano wykres] figs/panel_maps_semi_implicit.png
[Zapisano wykres] figs/panel_tb_compare.png
[OK] Moduł PDE załadowany.
[OK] Wczytano PDE z: out/compare_solvers_same_dt.csv
[OK] Dane PDE: 61 punktów czasowych, t ∈ [0.00, 6.00]
[INFO] Używam domyślnych parametrów ODE
[OK] Symulacja ODE zakończona
     RMSE(ODE vs PDE): 0.718030
     MAE(ODE vs PDE):  0.691427
[Supermodel] Sieć korekcyjna: 4804 parametrów
[Supermodel] Start treningu...
[Supermodel] Early stopping at epoch 508
[Supermodel] Trening zakończony. Finalna strata: 0.515567
[OK] Model Supermodel zapisany do out/supermodel_correction_net.pt
[Zapisano JSON] out/supermodel_metrics.json
[Zapisano CSV] out/supermodel_tb_curves.csv
[Zapisano wykres] figs/supermodel_tb_compare.png

[Supermodel] Metryki:
  ODE_vs_PDE: RMSE=0.718030, MAE=0.691427
  Supermodel_vs_PDE: RMSE=0.718030, MAE=0.691427
  Supermodel_vs_ODE: RMSE=0.000000, MAE=0.000000

[SuperNet] Generowanie danych PDE dla różnych scenariuszy...
  Scenariusz p_dose = 0.5...
    -> TB(T=5.99) = 0.0322
  Scenariusz p_dose = 1.0...
    -> TB(T=5.99) = 0.0217
  Scenariusz p_dose = 1.5...
    -> TB(T=5.99) = 0.0161

[SuperNet] Dane treningowe przygotowane:
  Punkty kolokacyjne: 1998
  Warunki początkowe: 498
  Punkty TB(t): 39

[SuperNet] Parametry sieci: 0.08M

[SuperNet] Start treningu...
[SuperNet] Trening zakończony. Finalna strata: 0.794933
[OK] Model SuperNet zapisany do out/supernet_model.pt

[SuperNet] Ewaluacja dla scenariuszy...
  Scenariusz p_dose = 0.5...
[Zapisano wykres] out/supermodel_supernet_tb_dose05.png
    RMSE(SuperNet vs PDE): 0.067321
  Scenariusz p_dose = 1.0...
[Zapisano wykres] out/supermodel_supernet_tb_dose10.png
    RMSE(SuperNet vs PDE): 0.073277
  Scenariusz p_dose = 1.5...
[Zapisano wykres] out/supermodel_supernet_tb_dose15.png
    RMSE(SuperNet vs PDE): 0.077276
[Zapisano JSON] out/supernet_metrics.json

[SuperNet] Podsumowanie metryk:

  dose_0.5:
    ODE_vs_PDE: RMSE=0.791025, MAE=0.779339
    Supermodel_vs_PDE: RMSE=0.791023, MAE=0.779338
    SuperNet_vs_PDE: RMSE=0.067321, MAE=0.067143

  dose_1.0:
    ODE_vs_PDE: RMSE=0.704163, MAE=0.674941
    Supermodel_vs_PDE: RMSE=0.704160, MAE=0.674938
    SuperNet_vs_PDE: RMSE=0.073277, MAE=0.072775

  dose_1.5:
    ODE_vs_PDE: RMSE=0.647799, MAE=0.602523
    Supermodel_vs_PDE: RMSE=0.647793, MAE=0.602518
    SuperNet_vs_PDE: RMSE=0.077276, MAE=0.076539

======================================================================
PODSUMOWANIE ZADANIA 7
======================================================================

[SUPERMODEL]
  Model: ODE + neuronowa korekta g_φ(y,t)
  Parametry sieci: 4804
  Zapisane pliki:
    - out/supermodel_correction_net.pt
    - out/supermodel_metrics.json
    - out/supermodel_tb_curves.csv
    - out/supermodel_tb_compare.png

[SUPERNET]
  Model: PINN rozszerzony o parametr terapii (x,y,t,p)
  Parametry sieci: 0.08M
  Scenariusze treningowe: [0.5, 1.0, 1.5]
  Zapisane pliki:
    - out/supernet_model.pt
    - out/supernet_metrics.json
    - supermodel_supernet_tb_dose05.png
    - supermodel_supernet_tb_dose10.png
    - supermodel_supernet_tb_dose15.png

[METRYKI - Scenariusz nominalny p_dose=1.0]
  Supermodel vs PDE: RMSE=0.718030
  SuperNet vs PDE:   RMSE=0.073277

======================================================================
Zadanie 7 zakończone!
======================================================================
